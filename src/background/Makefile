################################################################################
## CONFIG ######################################################################
################################################################################
SRC_DIR ?= src
TARGET_FILE ?= $(WWW_DIR)/script/main_background.js

ELM_CC ?= elm-make --warn

MAIN_MODULE ?= $(SRC_DIR)/Main.elm

################################################################################
## MAKEFILE MAGIC ##############################################################
################################################################################
SUB_MODULES = $(shell find $(SRC_DIR) -type f | grep "elm$$")

################################################################################
## SANITY CHECKS ###############################################################
################################################################################

################################################################################
## TARGET RULES ################################################################
################################################################################
build: $(TARGET_FILE)

clean:
	rm -f $(TARGET_FILE)

reset:
	rm -rf elm-stuff

################################################################################
## INTERNAL RULES ##############################################################
################################################################################
$(TARGET_FILE): $(MAIN_MODULE) $(SUB_MODULES)
	$(ELM_CC) $(MAIN_MODULE) --output $@
